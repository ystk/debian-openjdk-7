# HG changeset patch
# User serb
# Date 1432338590 -10800
#      Sat May 23 02:49:50 2015 +0300
# Node ID 5f5d2ee0a189cf9fe7fa768bce63b06f2a3f74f5
# Parent  3f18e62cfff7bfe06c6c363d3a2a6ea297f8424b
8080541: More direct property handling
Reviewed-by: prr, alexsch

Index: openjdk/jdk/src/share/classes/java/beans/PropertyDescriptor.java
===================================================================
--- openjdk/jdk/src/share/classes/java/beans/PropertyDescriptor.java.orig
+++ openjdk/jdk/src/share/classes/java/beans/PropertyDescriptor.java
@@ -1,5 +1,5 @@
 /*
- * Copyright (c) 1996, 2014, Oracle and/or its affiliates. All rights reserved.
+ * Copyright (c) 1996, 2015, Oracle and/or its affiliates. All rights reserved.
  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  *
  * This code is free software; you can redistribute it and/or modify it
@@ -28,6 +28,7 @@ package java.beans;
 import java.lang.ref.Reference;
 import java.lang.reflect.Method;
 import java.lang.reflect.Constructor;
+import sun.reflect.misc.ReflectUtil;
 
 /**
  * A PropertyDescriptor describes one property that a Java Bean
@@ -424,8 +425,9 @@ public class PropertyDescriptor extends
     public PropertyEditor createPropertyEditor(Object bean) {
         Object editor = null;
 
-        Class cls = getPropertyEditorClass();
-        if (cls != null) {
+        final Class cls = getPropertyEditorClass();
+        if (cls != null && PropertyEditor.class.isAssignableFrom(cls)
+                && ReflectUtil.isPackageAccessible(cls)) {
             Constructor ctor = null;
             if (bean != null) {
                 try {
