# HG changeset patch
# User poonam
# Date 1438266667 25200
#      Thu Jul 30 07:31:07 2015 -0700
# Node ID e9de15763a5a3cef64ef1d4bc40a018d4d572325
# Parent  cf0cf52d0c6ca13ac11e48296f4ee712a4aa034d
8087350: Improve array conversions
Reviewed-by: jbachorik, kevinw

Index: openjdk/jdk/src/share/classes/javax/management/openmbean/OpenMBeanAttributeInfoSupport.java
===================================================================
--- openjdk/jdk/src/share/classes/javax/management/openmbean/OpenMBeanAttributeInfoSupport.java.orig
+++ openjdk/jdk/src/share/classes/javax/management/openmbean/OpenMBeanAttributeInfoSupport.java
@@ -762,11 +762,15 @@ public class OpenMBeanAttributeInfoSuppo
         Class<?> stringArrayClass;
         Class<?> targetArrayClass;
         try {
+            String baseClassName = baseType.safeGetClassName();
+
+            // check access to the provided base type class name and bail out early
+            ReflectUtil.checkPackageAccess(baseClassName);
+
             stringArrayClass =
                 Class.forName(squareBrackets + "Ljava.lang.String;");
             targetArrayClass =
-                Class.forName(squareBrackets + "L" + baseType.safeGetClassName() +
-                              ";");
+                Class.forName(squareBrackets + "L" + baseClassName + ";");
         } catch (ClassNotFoundException e) {
             throw new NoClassDefFoundError(e.toString());  // can't happen
         }
