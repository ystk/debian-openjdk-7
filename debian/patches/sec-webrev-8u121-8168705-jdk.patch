# HG changeset patch
# User robm
# Date 1479480772 0
#      Fri Nov 18 14:52:52 2016 +0000
# Node ID 683c9263a5b1ab525db02d15f0c3de62a09dba75
# Parent  41594ac7ca2795d64fecd107d114c0034078ac67
8168705: Better ObjectIdentifier validation
Reviewed-by: ascarpino

--- openjdk/jdk/src/share/classes/sun/security/util/ObjectIdentifier.java.orig
+++ openjdk/jdk/src/share/classes/sun/security/util/ObjectIdentifier.java
@@ -255,7 +255,13 @@ class ObjectIdentifier implements Serial
                 + " (tag = " +  type_id + ")"
                 );
 
-        encoding = new byte[in.getLength()];
+        int len = in.getLength();
+        if (len > in.available()) {
+            throw new IOException("ObjectIdentifier() -- length exceeds" +
+                    "data available.  Length: " + len + ", Available: " +
+                    in.available());
+        }
+        encoding = new byte[len];
         in.getBytes(encoding);
         check(encoding);
     }
